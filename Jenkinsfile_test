pipeline {
   agent any
   //def mvnHome = "/var/jenkins_home/maven/apache-maven-3.6.3"
   stages {
      stage('clone repo') {
         steps {
            git 'https://github.com/dilligence1991/docker-hello-world-spring-boot.git'
         }
      }
      stage('build archive') {
         steps {
            sh "/var/jenkins_home/maven/apache-maven-3.6.3/bin/mvn -Dmaven.test.failure.ignore clean package"
         }    
      }
      stage('Publish tests Result'){
         steps {
          parallel(
               publishJunitTestsResultsToJenkins: {
                  echo "Publish junit Tests Results"
		            junit '**/target/surefire-reports/TEST-*.xml'
		             archive 'target/*.jar'
               },
               publishJunitTestsResultsToSonar: {
                   echo "This is branch b"
               })
         }
      }
      stage('Build Docker Image') {
         steps {
            sh "whoami"
            sh "ls -all /var/run/docker.sock"
            sh "mv ./target/hello*.jar ./data" 
            script {
	    def dockerImage
	    }
            //dockerImage = docker.build("hello-world-java")
         }    
      }
   }
}

